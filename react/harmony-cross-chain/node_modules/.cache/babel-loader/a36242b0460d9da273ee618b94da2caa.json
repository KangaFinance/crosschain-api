{"ast":null,"code":"\"use strict\";\n/**\n * @packageDocumentation\n * @module harmony-network\n * @ignore\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.composeMiddleware = exports.performRPC = exports.DEFAULT_HEADERS = exports.DEFAULT_TIMEOUT = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nexports.DEFAULT_TIMEOUT = 120000;\nexports.DEFAULT_HEADERS = {\n  'Content-Type': 'application/json'\n};\n\nfunction _fetch(fetchPromise, timeout) {\n  var abortFn;\n  var abortPromise = new Promise(function (resolve, reject) {\n    abortFn = function () {\n      return reject(new Error(\"request Timeout in \" + timeout + \" ms\"));\n    };\n  });\n  var abortablePromise = Promise.race([fetchPromise, abortPromise]);\n  setTimeout(function () {\n    abortFn();\n  }, timeout);\n  return abortablePromise;\n}\n\nexports.performRPC = function (request, handler, fetcher) {\n  return tslib_1.__awaiter(void 0, void 0, void 0, function () {\n    var response, err_1;\n    return tslib_1.__generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          _a.trys.push([0, 2,, 3]);\n\n          return [4\n          /*yield*/\n          , _fetch(fetcher.requestHandler(request, exports.DEFAULT_HEADERS), request.options && request.options.timeout ? request.options.timeout : exports.DEFAULT_TIMEOUT)];\n\n        case 1:\n          response = _a.sent();\n          return [2\n          /*return*/\n          , fetcher.responseHandler(response, request, handler)];\n\n        case 2:\n          err_1 = _a.sent();\n          throw err_1;\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n};\n\nfunction composeMiddleware() {\n  var fns = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    fns[_i] = arguments[_i];\n  }\n\n  if (fns.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (fns.length === 1) {\n    return fns[0];\n  }\n\n  return fns.reduce(function (a, b) {\n    return function (arg) {\n      return a(b(arg));\n    };\n  });\n}\n\nexports.composeMiddleware = composeMiddleware;","map":{"version":3,"sources":["../../src/rpcMethod/net.ts"],"names":[],"mappings":";AAAA;;;;AAIG;;;;;;;;;AAEU,OAAA,CAAA,eAAA,GAA0B,MAA1B;AAEA,OAAA,CAAA,eAAA,GAA0B;AAAE,kBAAgB;AAAlB,CAA1B;;AAEb,SAAS,MAAT,CAAgB,YAAhB,EAA4C,OAA5C,EAA2D;AACzD,MAAI,OAAJ;AAEA,MAAM,YAAY,GAAG,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAgB;AAC/C,IAAA,OAAO,GAAG,YAAA;AAAM,aAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,wBAAsB,OAAtB,GAAjB,KAAO,CAAD,CAAN;AAAqD,KAArE;AACD,GAFoB,CAArB;AAGA,MAAM,gBAAgB,GAAG,OAAO,CAAC,IAAR,CAAa,CAAC,YAAD,EAAe,YAAf,CAAb,CAAzB;AAEA,EAAA,UAAU,CAAC,YAAA;AACT,IAAA,OAAO;AACR,GAFS,EAEP,OAFO,CAAV;AAIA,SAAO,gBAAP;AACD;;AAEY,OAAA,CAAA,UAAA,GAAa,UAAO,OAAP,EAAqB,OAArB,EAAmC,OAAnC,EAA+C;AAAA,SAAA,OAAA,CAAA,SAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,YAAA;;;;;;;AAEpD,iBAAA,CAAA;AAAA;AAAA,YAAM,MAAM,CAC3B,OAAO,CAAC,cAAR,CAAuB,OAAvB,EAAgC,OAAA,CAAA,eAAhC,CAD2B,EAE3B,OAAO,CAAC,OAAR,IAAmB,OAAO,CAAC,OAAR,CAAgB,OAAnC,GAA6C,OAAO,CAAC,OAAR,CAAgB,OAA7D,GAAuE,OAAA,CAAA,eAF5C,CAAZ,CAAA;;;AAAX,UAAA,QAAQ,GAAG,EAAA,CAAA,IAAA,EAAX;AAIN,iBAAA,CAAA;AAAA;AAAA,YAAO,OAAO,CAAC,eAAR,CAAwB,QAAxB,EAAkC,OAAlC,EAA2C,OAA3C,CAAP,CAAA;;;;AAEA,gBAAM,KAAN;;;;;;;;GARqE,CAAA;AAUxE,CAVY;;AAYb,SAAgB,iBAAhB,GAAiC;AAAC,MAAA,GAAA,GAAA,EAAA;;OAAA,IAAA,EAAA,GAAA,C,EAAA,EAAA,GAAA,SAAA,CAAA,M,EAAA,EAAA,E,EAAa;AAAb,IAAA,GAAA,CAAA,EAAA,CAAA,GAAA,SAAA,CAAA,EAAA,CAAA;;;AAChC,MAAI,GAAG,CAAC,MAAJ,KAAe,CAAnB,EAAsB;AACpB,WAAO,UAAC,GAAD,EAAS;AAAK,aAAA,GAAA;AAAG,KAAxB;AACD;;AAED,MAAI,GAAG,CAAC,MAAJ,KAAe,CAAnB,EAAsB;AACpB,WAAO,GAAG,CAAC,CAAD,CAAV;AACD;;AAED,SAAO,GAAG,CAAC,MAAJ,CAAW,UAAC,CAAD,EAAI,CAAJ,EAAK;AAAK,WAAA,UAAC,GAAD,EAAS;AAAK,aAAA,CAAC,CAAC,CAAC,CAAH,GAAG,CAAF,CAAD;AAAd,KAAA;AAAuB,GAA5C,CAAP;AACD;;AAVD,OAAA,CAAA,iBAAA,GAAA,iBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\n/**\n * @packageDocumentation\n * @module harmony-network\n * @ignore\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.composeMiddleware = exports.performRPC = exports.DEFAULT_HEADERS = exports.DEFAULT_TIMEOUT = void 0;\nvar tslib_1 = require(\"tslib\");\nexports.DEFAULT_TIMEOUT = 120000;\nexports.DEFAULT_HEADERS = { 'Content-Type': 'application/json' };\nfunction _fetch(fetchPromise, timeout) {\n    var abortFn;\n    var abortPromise = new Promise(function (resolve, reject) {\n        abortFn = function () { return reject(new Error(\"request Timeout in \" + timeout + \" ms\")); };\n    });\n    var abortablePromise = Promise.race([fetchPromise, abortPromise]);\n    setTimeout(function () {\n        abortFn();\n    }, timeout);\n    return abortablePromise;\n}\nexports.performRPC = function (request, handler, fetcher) { return tslib_1.__awaiter(void 0, void 0, void 0, function () {\n    var response, err_1;\n    return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                _a.trys.push([0, 2, , 3]);\n                return [4 /*yield*/, _fetch(fetcher.requestHandler(request, exports.DEFAULT_HEADERS), request.options && request.options.timeout ? request.options.timeout : exports.DEFAULT_TIMEOUT)];\n            case 1:\n                response = _a.sent();\n                return [2 /*return*/, fetcher.responseHandler(response, request, handler)];\n            case 2:\n                err_1 = _a.sent();\n                throw err_1;\n            case 3: return [2 /*return*/];\n        }\n    });\n}); };\nfunction composeMiddleware() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    if (fns.length === 0) {\n        return function (arg) { return arg; };\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return fns.reduce(function (a, b) { return function (arg) { return a(b(arg)); }; });\n}\nexports.composeMiddleware = composeMiddleware;\n//# sourceMappingURL=net.js.map"]},"metadata":{},"sourceType":"script"}